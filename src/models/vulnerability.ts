import { model, Model, Schema } from "mongoose";
import { IVulnerability } from "./interfaces";

const vulnerabilitySchema = new Schema<IVulnerability>({
  cveId: {
    type: String,
    required: true,
  },
  description: {
    type: String,
    required: true,
  },
  score: {
    type: Number,
    required: true,
  },
  severity: {
    type: String,
  },
  cwes: [
    {
      type: String,
      required: true,
    },
  ],
  availabilityImpact: String,
  confidentialityImpact: String,
  integrityImpact: String,
});
const Vulnerability: Model<IVulnerability> = model(
  "Vulnerability",
  vulnerabilitySchema
);

export { Vulnerability, vulnerabilitySchema };
